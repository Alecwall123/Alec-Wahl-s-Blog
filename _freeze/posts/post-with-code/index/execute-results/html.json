{
  "hash": "212bf73158e4260c77f66a4ba38ee65d",
  "result": {
    "markdown": "---\ntitle: \"Post #2- Swiss Analysis \"\nauthor: \"Alec Wahl\"\ndate: \"2023-11-05\"\ncategories: [analysis]\n---\n\n\n![](images/swissflagdata.jpg){width=\"461\" height=\"306\"}\n\nWe are doing are going to analyze, a built in r-dataset called \"swiss\" this is a dataset takenfrom various socioeconomic indicators from Swiss Provinces.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr)\nlibrary(parsnip)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ─────────────────── tidyverse 2.0.0.9000 ──\n✔ dplyr     1.1.3     ✔ purrr     1.0.2\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: carData\n\nAttaching package: 'car'\n\nThe following object is masked from 'package:dplyr':\n\n    recode\n\nThe following object is masked from 'package:purrr':\n\n    some\n```\n:::\n\n```{.r .cell-code}\nlibrary(lmtest)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: zoo\n\nAttaching package: 'zoo'\n\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n```\n:::\n\n```{.r .cell-code}\nlibrary(broom)\nlibrary(dplyr)\nlibrary(leaps)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"swiss\")\n\nswiss %>%\n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 47\nColumns: 6\n$ Fertility        <dbl> 80.2, 83.1, 92.5, 85.8, 76.9, 76.1, 83.8, 92.4, 82.4,…\n$ Agriculture      <dbl> 17.0, 45.1, 39.7, 36.5, 43.5, 35.3, 70.2, 67.8, 53.3,…\n$ Examination      <int> 15, 6, 5, 12, 17, 9, 16, 14, 12, 16, 14, 21, 14, 19, …\n$ Education        <int> 12, 9, 5, 7, 15, 7, 7, 8, 7, 13, 6, 12, 7, 12, 5, 2, …\n$ Catholic         <dbl> 9.96, 84.84, 93.40, 33.77, 5.16, 90.57, 92.85, 97.16,…\n$ Infant.Mortality <dbl> 22.2, 22.2, 20.2, 20.3, 20.6, 26.6, 23.6, 24.9, 21.0,…\n```\n:::\n:::\n\n\nAs seen above, this data has 6 including various different socioeconomic/fertility data from 47 different French-speaking Provinces.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nswiss %>%\n  ggplot(aes(x = Examination, y = Fertility)) +\n  geom_point() +\n  labs(title = \"Fertility vs. Examination\",\n       x = \"Examination\",\n       y = \"Fertility\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nswiss %>%\n  ggplot(aes(x = Education, y = Fertility)) +\n  geom_point() +\n  labs(title = \"Fertility vs. Education\",\n       x = \"Examination\",\n       y = \"Fertility\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n\n\nLets first graph, fertility vs examination, then fertility vs education. Due to the nature of education potentially affecting the score someone has on the examination I am going to analyze whether adding an interaction term between these two predictor variable will improve the quality of my model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nswissmodel1 <- linear_reg() %>%\n  set_engine(\"lm\") %>%\n  fit(Fertility ~ Education+Examination, data = swiss)\ntidy(swissmodel1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)   85.3       3.09      27.6  1.95e-29\n2 Education     -0.539     0.192     -2.80 7.50e- 3\n3 Examination   -0.557     0.232     -2.40 2.06e- 2\n```\n:::\n\n```{.r .cell-code}\nswissmodel2 <- linear_reg() %>%\n  set_engine(\"lm\") %>%\n  fit(Fertility ~ Education+Examination+Education:Examination, data = swiss)\ntidy(swissmodel2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 × 5\n  term                  estimate std.error statistic  p.value\n  <chr>                    <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)           87.2        4.33      20.1   1.70e-23\n2 Education             -0.808      0.463     -1.74  8.86e- 2\n3 Examination           -0.626      0.257     -2.43  1.92e- 2\n4 Education:Examination  0.00920    0.0145     0.637 5.28e- 1\n```\n:::\n:::\n\n\nAs seen above, the p values for most of\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova_result <- anova(swissmodel1$fit,swissmodel2$fit) %>%\n  tidy()%>%\n  print()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 7\n  term                           df.residual   rss    df sumsq statistic p.value\n  <chr>                                <dbl> <dbl> <dbl> <dbl>     <dbl>   <dbl>\n1 Fertility ~ Education + Exami…          44 3550.    NA  NA      NA      NA    \n2 Fertility ~ Education + Exami…          43 3516.     1  33.2     0.405   0.528\n```\n:::\n\n```{.r .cell-code}\nswissmodel1$fit%>%\n  vif()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Education Examination \n   1.952301    1.952301 \n```\n:::\n:::\n\n\nThe last to\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}